subdir('glcheck')

test('main_menu',
    find_program('watch-for-msg.py'),
    args: [
        naev_sh,
        'Reached main menu'
    ],
    env: ['WITHGDB=NO'],
    workdir: meson.source_root(),
    protocol: 'exitcode'
    )

if (ascli_exe.found())
    metainfo_test_file = 'org.naev.naev.metainfo.xml'
    test('validate_metainfo',
    ascli_exe,
    args: [
        'validate',
        '--no-net',
        '--pedantic',
        '--verbose',
        metainfo_test_file
    ],
    workdir: meson.source_root()
    )
endif

if (luacheck_exe.found())
    luacheck_config_file = join_paths(meson.source_root(), 'test', 'luacheckrc')
    test('lua_lint',
    luacheck_exe,
    args: [
        join_paths(meson.source_root(), 'dat'),
        '--config=' + luacheck_config_file,
        '--no-color'
    ]
    )
endif
